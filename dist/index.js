!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).Store={})}(this,(function(t){"use strict";function e(){}const s=[];const i=t=>JSON.parse(JSON.stringify(t));class o extends class{constructor(){this._eventList={}}$subscribe(t,e){Array.isArray(this._eventList[t])||(this._eventList[t]=[]),this._eventList[t].push(e)}$emit(t,...e){this._eventList[t]&&this._eventList[t].forEach(t=>{t(...e)})}$events(){return Object.keys(this._eventList)}$remove(t,e){if(e){const s=this._eventList[t].findIndex(t=>t.toString()===e.toString());s>=0&&this._eventList[t].splice(s,1)}else t&&!e&&delete this._eventList[t]}}{constructor(t,e){super(),this._init(t,e),this._initGlobalPlugin()}_init(t,i){if(i&&(this.name=i),"[object Object]"!==Object.prototype.toString.call(t))throw new Error("state expect object type");this._state=function(t,i=e){let o;const n=[];function r(e){if(r=e,((i=t)!=i?r==r:i!==r||i&&"object"==typeof i||"function"==typeof i)&&(t=e,o)){const e=!s.length;for(let e=0;e<n.length;e+=1){const i=n[e];i[1](),s.push(i,t)}if(e){for(let t=0;t<s.length;t+=2)s[t][0](s[t+1]);s.length=0}}var i,r}return{set:r,update:function(e){r(e(t))},subscribe:function(s,c=e){const h=[s,c];return n.push(h),1===n.length&&(o=i(r)||e),s(t),()=>{const t=n.indexOf(h);-1!==t&&n.splice(t,1),0===n.length&&(o(),o=null)}}}}(t),this._cache=void 0,this.state(t=>this._cache=t)}_initGlobalPlugin(){if(this._globalPlugins)for(const t of this._globalPlugins)this.use(t)}state(t){try{if(void 0===t)return i(this._cache);this._state.subscribe(e=>{t(i(e))})}catch(t){console.log("[get state error]:",t)}}registerGetter(t){if("[object Object]"!==Object.prototype.toString.call(t))throw new Error("getters expect object type");this._getters=t}registerMutation(t){if("[object Object]"!==Object.prototype.toString.call(t))throw new Error("mutations expect object type");this._mutations=t}registerAction(t){if("[object Object]"!==Object.prototype.toString.call(t))throw new Error("actions expect object type");this._actions=t}use(t){if("function"!=typeof t)throw new Error("plugin must be a function");t(this)}getter(t,e){try{if(void 0===e)return this._getters[t](i(this._cache));this.state(s=>{const o=this._getters[t](i(s));if(void 0===o)throw new Error("getter must return a valid value but not undefined");e(o)})}catch(t){console.log("[getter error]:",t)}}commit(t,...e){try{const s=t=>{this._state.update(e=>{for(const s of Object.keys(t))this._cache.hasOwnProperty(s)?e[s]=t[s]:console.warn(`property '${s}' is not existed on store state`);return e})},o={state:i(this._cache),setState:s,getter:t=>this.getter.call(this,t)};this._mutations[t](o,...e),this.$emit("mutation",{type:t,payload:e})}catch(t){console.log("[commit error]:",t)}}dispatch(t,...e){try{const s={state:i(this._cache),getter:t=>this.getter.call(this,t),commit:(t,...e)=>this.commit.call(this,t,...e),dispatch:(t,...e)=>this.dispatch.call(this,t,...e)};this._actions[t](s,...e),this.$emit("action",{type:t,payload:e})}catch(t){console.log("[dispatch error]:",t)}}}
/**!
     * @name svelte/storeManager
     * @author Alan chen
     * @since 2020/1/14
     * @license Anti996
     */t.createStore=(t,e)=>new o(t,e),t.useGlobalPlugins=t=>{o.prototype._globalPlugins=t},Object.defineProperty(t,"__esModule",{value:!0})}));
